<html>
<head>
<title>Backorder</title></head>
<body>

<h2>Set things up</h2>
<i><b>
In this example, we've got three different products. An order comes in for all three, and for more than we have in inventory.
So we want to put the order on hold until we get more inventory in. The products may come in separate shipments, so
the order should be set to backordered until all products are in and in enough quantity to fill the order.
</b></i>

<table border="1" cellspacing="0">
<tr><td>com.sabre.apd.fixture.ClearOrdersFixture</td></tr>
</table>
<table border="1" cellspacing="0">
<tr><td>com.sabre.apd.fixture.ClearWarehouseFixture</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="5">com.sabre.apd.fixture.SetupCatalogFixture</td></tr>
<tr><td>name</td><td>catalogId</td><td>description</td><td>price</td><td>downloadable</td><td>success()</td></tr>
<tr><td>Widget</td><td>1</td><td>Does the work</td><td>20</td><td>false</td><td>true</td></tr>
<tr><td>Gadget</td><td>2</td><td>Made up of widgets</td><td>100</td><td>false</td><td>true</td></tr>
<tr><td>Device</td><td>3</td><td>Gadgets working together</td><td>5000</td><td>false</td><td>true</td></tr>
<tr><td>Software</td><td>4</td><td>Software to control a device</td><td>12500</td><td>true</td><td>true</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.SetupWarehouseFixture</td></tr>
<tr><td>catalogId</td><td>count</td><td>success()</td></tr>
<tr><td>1</td><td>5</td><td>true</td></tr>
<tr><td>2</td><td>5</td><td>true</td></tr>
<tr><td>3</td><td>0</td><td>true</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="5">com.sabre.apd.fixture.ViewCatalogFixture</td></tr>
<tr><td>getCatalogNumber()</td><td>getName()</td><td>getDescription()</td><td>getPrice()</td><td>getStatus()</td></tr>
<tr><td>1</td><td>Widget</td><td>Does the work</td><td>20</td><td>ships immediately</td></tr>
<tr><td>2</td><td>Gadget</td><td>Made up of widgets</td><td>100</td><td>ships immediately</td></tr>
<tr><td>3</td><td>Device</td><td>Gadgets working together</td><td>5000</td><td>on order</td></tr>
<tr><td>4</td><td>Software</td><td>Software to control a device</td><td>12500</td><td>ships immediately</td></tr>
</table>

<br>
<br>
<br>
<h2>Place the order</h2>

<i><b>This adds multi-item orders. The shipping policy dictates what happens as the warehouse is restocked.
All at once means nothing is taken from the warehouse until there is enough inventory to fill
the entire order.</b></i>

<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.MultiLineItemOrderFixture</td></tr>
<tr><td>lineItems</td><td>shippingPolicy</td><td>placeOrderAndGetStatus()</td><td>&nbsp;</td></tr>
<tr><td>10 of 1,10 of 2,5 of 3</td><td>All At Once</td><td>On Order</td><td>10 Widgets<p>10 Gadgets<p>5 Devices<p>5 software licenses</td></tr>
</table>

<br>
<i><b> This order is for more than we have of the 3 products. So the
order can't be filled. The products should be listed in the catalog as
on order, and the order status should be backordered.</b></i>
<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.ViewActiveOrdersFixture</td></tr>
<tr><td>getOrderNumber()</td><td>totalPrice()</td><td>getStatus()</td></tr>
<tr><td>1</td><td>26200</td><td>On Order</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="5">com.sabre.apd.fixture.ViewCatalogFixture</td></tr>
<tr><td>getCatalogNumber()</td><td>getName()</td><td>getDescription()</td><td>getPrice()</td><td>&nbsp;</td></tr>
<tr><td>1</td><td>Widget</td><td>Does the work</td><td>20</td><td>on order</td></tr>
<tr><td>2</td><td>Gadget</td><td>Made up of widgets</td><td>100</td><td>on order</td></tr>
<tr><td>3</td><td>Device</td><td>Gadgets working together</td><td>5000</td><td>on order</td></tr>
<tr><td>4</td><td>Software</td><td>Software to control a device</td><td>12500</td><td>ships immediately</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="2">com.sabre.apd.fixture.CheckInventoryFixture</td></tr>
<tr><td>getId()</td><td>getCount()</td></tr>
<tr><td>1</td><td>5</td></tr>
<tr><td>2</td><td>5</td></tr>
<tr><td>3</td><td>0</td></tr>
</table>

<br>
<br>
<br>

<h2>Wait for new product</h2>
<i><b>This fixture mimics a new shipment of some product arriving at the warehouse. This should allow backorders to be filled.
Here we get new Widgets in. Gadgets and Devices are still on order</b></i>

<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.RestockInventoryFixture</td></tr>
<tr><td>catalogId</td><td>count</td><td>updateInventory()</td></tr>
<tr><td>1</td><td>5</td><td>true</td></tr>
</table>

<br>

<i><b>Notice that the inventory appears as if no order has yet been filled. Nothing is taken from inventory until
the entire order can be filled. So sayeth The Customer.</b></i>

<table border="1" cellspacing="0">
<tr><td colspan="2">com.sabre.apd.fixture.CheckInventoryFixture</td></tr>
<tr><td>getId()</td><td>getCount()</td></tr>
<tr><td>1</td><td>10</td></tr>
<tr><td>2</td><td>5</td></tr>
<tr><td>3</td><td>0</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="5">com.sabre.apd.fixture.ViewCatalogFixture</td></tr>
<tr><td>getCatalogNumber()</td><td>getName()</td><td>getDescription()</td><td>getPrice()</td><td>&nbsp;</td></tr>
<tr><td>1</td><td>Widget</td><td>Does the work</td><td>20</td><td>ships immediately</td></tr>
<tr><td>2</td><td>Gadget</td><td>Made up of widgets</td><td>100</td><td>on order</td></tr>
<tr><td>3</td><td>Device</td><td>Gadgets working together</td><td>5000</td><td>on order</td></tr>
<tr><td>4</td><td>Software</td><td>Software to control a device</td><td>12500</td><td>ships immediately</td></tr>
</table>

<br>

<i><b>This is still backordered until more Gadgets and Devices come in.</b></i>

<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.ViewActiveOrdersFixture</td></tr>
<tr><td>getOrderNumber()</td><td>totalPrice()</td><td>getStatus()</td></tr>
<tr><td>1</td><td>26200</td><td>On Order</td></tr>
</table>

<br>
<br>
<br>

<h2>Finally,we can ship</h2>
<i><b>Now we get 7 new Gadgets in, 5 of which are spoken for, and 5 new devices, all of which are spoken for</b></i>

<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.RestockInventoryFixture</td></tr>
<tr><td>catalogId</td><td>count</td><td>updateInventory()</td></tr>
<tr><td>2</td><td>7</td><td>true</td></tr>
<tr><td>3</td><td>5</td><td>true</td></tr>
</table>

<br>

<table border="1" cellspacing="0">
<tr><td colspan="2">com.sabre.apd.fixture.CheckInventoryFixture</td></tr>
<tr><td>getId()</td><td>getCount()</td></tr>
<tr><td>1</td><td>0</td></tr>
<tr><td>2</td><td>2</td></tr>
<tr><td>3</td><td>0</td></tr>
</table>

<br>

<i><b>The order should no longer be backordered.</b></i>


<table border="1" cellspacing="0">
<tr><td colspan="3">com.sabre.apd.fixture.ViewActiveOrdersFixture</td></tr>
<tr><td>getOrderNumber()</td><td>totalPrice()</td><td>getStatus()</td></tr>
<tr><td>1</td><td>26200</td><td>Shipped</td></tr>
</table>


</body>
</html>